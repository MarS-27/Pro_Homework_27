{"version":3,"file":"index.js","sources":["index.js"],"sourcesContent":["const API = \"https://5dd3d5ba8b5e080014dc4bfa.mockapi.io\";\r\n\r\nconst addForm = document.getElementById(\"addStudentForm\");\r\nconst loader = document.getElementById(\"loader\");\r\n\r\nconst controller = async (path, method = \"GET\", body) => {\r\n    let URL = `${API}/${path}`;\r\n    \r\n    const params = {\r\n        method,\r\n        headers: {\r\n            \"content-type\": \"application/json\",\r\n        }\r\n    }\r\n\r\n    if (body) params.body = JSON.stringify(body);\r\n\r\n    let request = await fetch(URL, params);\r\n    \r\n    loader.classList.add(\"visible\");\r\n\r\n    if (request.ok) {\r\n        loader.classList.remove(\"visible\");\r\n        let responce = await request.json();\r\n        return responce; \r\n    } else {\r\n        alert(`Error ${request.status}! ${request.statusText}`);\r\n    }\r\n} \r\n\r\nasync function studentsList() {\r\n    const studentsArr = await controller(\"students\");\r\n\r\n    studentsArr.map(student => {\r\n        const studenInfo = new Student(student);\r\n        studenInfo.render(); \r\n    })\r\n}\r\n\r\naddForm.addEventListener(\"submit\", async e => {\r\n    e.preventDefault();\r\n    loader.classList.add(\"visible\");\r\n\r\n    const studentName = document.getElementById(\"studentName\").value.trim();\r\n\r\n    const body = {\r\n        name: studentName,\r\n    }\r\n\r\n    if (studentName !== \"\") {\r\n        const addStudent = await controller(\"students\", \"POST\", body);\r\n\r\n        if (addStudent) {\r\n            const newStudent = new Student(addStudent);\r\n            newStudent.render();\r\n            addForm.reset();\r\n        }\r\n    } else {\r\n        alert(\"Please, enter student name!\");\r\n    }\r\n})\r\n\r\nclass Student {\r\n    constructor(studentObj){\r\n        for(let key in studentObj) {\r\n            this[key] = studentObj[key];\r\n        }  \r\n    }\r\n\r\n    render() {\r\n        const tBody = document.getElementById(\"tbody\");\r\n       \r\n        const trList = `\r\n            <tr class=\"students__table-rows\" id=\"${this.id}\">\r\n                <td class=\"student__name\">\r\n                    ${this.name}\r\n                    <button class=\"button delete-btn\" id=\"delete-${this.id}\">Delete</button>\r\n                </td>\r\n                ${this.renderRating()}\r\n            </tr>\r\n        `;\r\n\r\n        tBody.insertAdjacentHTML(\"afterbegin\", trList);\r\n\r\n        this.deleteStudent();\r\n        this.changeMark();\r\n    }\r\n\r\n    renderRating() {\r\n        return this.marks.map((mark, i) => {\r\n            return `\r\n                <td>\r\n                    <input class=\"students__marks\" type=\"text\" value=\"${mark}\" id=\"${this.name}_${i}\">\r\n                </td>\r\n            `; \r\n        })\r\n        .join(\"\");\r\n    } \r\n    \r\n    deleteStudent() {\r\n        const deleteBtn = document.getElementById(`delete-${this.id}`);\r\n\r\n        deleteBtn.addEventListener(\"click\", async () => {\r\n            loader.classList.add(\"visible\");\r\n\r\n            const studentInfo = document.getElementById(`${this.id}`);\r\n\r\n            const deleteStudent = await controller(`students/${this.id}`, \"DELETE\");\r\n\r\n            if (deleteStudent.id) {\r\n                studentInfo.remove();\r\n            }\r\n        }) \r\n    }\r\n\r\n    changeMark() {\r\n        this.marks.map((mark, i, arr) => {\r\n            const inputChange = document.getElementById(`${this.name}_${i}`);     \r\n\r\n            inputChange.addEventListener(\"change\", async () => {\r\n\r\n                arr[i] = parseInt(inputChange.value); \r\n\r\n                const body = {\r\n                    marks: arr,\r\n                };\r\n\r\n                await controller(`students/${this.id}`, \"PUT\", body);\r\n            })\r\n        })\r\n    }\r\n}\r\n\r\nstudentsList();"],"names":["API","addForm","document","getElementById","loader","controller","async","path","method","body","URL","params","headers","content-type","JSON","stringify","let","request","await","fetch","classList","add","ok","remove","json","alert","status","statusText","studentsList","studentsArr","map","student","studenInfo","Student","render","addEventListener","e","preventDefault","studentName","value","trim","name","addStudent","newStudent","reset","constructor","studentObj","key","this","tBody","trList","id","renderRating","insertAdjacentHTML","deleteStudent","changeMark","marks","mark","i","join","deleteBtn","studentInfo","arr","inputChange","parseInt"],"mappings":"AAAA,MAAMA,IAAM,8CAENC,QAAUC,SAASC,eAAe,gBAAgB,EAClDC,OAASF,SAASC,eAAe,QAAQ,EAEzCE,WAAaC,MAAOC,EAAMC,EAAS,MAAOC,KACxCC,EAASV,IAAH,IAAUO,EAEpB,MAAMI,EAAS,CACXH,OAAAA,EACAI,QAAS,CACLC,eAAgB,kBACpB,CACJ,EAEIJ,IAAME,EAAOF,KAAOK,KAAKC,UAAUN,CAAI,GAE3CO,IAAIC,EAAUC,MAAMC,MAAMT,EAAKC,CAAM,EAIrC,GAFAP,OAAOgB,UAAUC,IAAI,SAAS,EAE1BJ,EAAQK,GAGR,OAFAlB,OAAOgB,UAAUG,OAAO,SAAS,EAClBL,MAAMD,EAAQO,KAAK,EAGlCC,eAAeR,EAAQS,WAAWT,EAAQU,UAAY,CAE9D,EAEArB,eAAesB,eACX,MAAMC,EAAcX,MAAMb,WAAW,UAAU,EAE/CwB,EAAYC,IAAIC,IACZ,MAAMC,EAAa,IAAIC,QAAQF,CAAO,EACtCC,EAAWE,OAAO,CACtB,CAAC,CACL,CAEAjC,QAAQkC,iBAAiB,SAAgBC,MAAAA,IACrCA,EAAEC,eAAe,EACjBjC,OAAOgB,UAAUC,IAAI,SAAS,EAE9B,IAAMiB,EAAcpC,SAASC,eAAe,aAAa,EAAEoC,MAAMC,KAAK,EAEhE/B,EAAO,CACTgC,KAAMH,CACV,EAEA,GAAoB,KAAhBA,EAAoB,CACdI,EAAaxB,MAAMb,WAAW,WAAY,OAAQI,CAAI,EAE5D,GAAIiC,EAAY,CACZ,MAAMC,EAAa,IAAIV,QAAQS,CAAU,EACzCC,EAAWT,OAAO,EAClBjC,QAAQ2C,MAAM,CAClB,CACJ,MACInB,MAAM,6BAA6B,CAE3C,CAAC,QAEKQ,QACFY,YAAYC,GACR,IAAI9B,IAAI+B,KAAOD,EACXE,KAAKD,GAAOD,EAAWC,EAE/B,CAEAb,SACI,MAAMe,EAAQ/C,SAASC,eAAe,OAAO,EAE7C,IAAM+C;mDACqCF,KAAKG;;sBAElCH,KAAKP;mEACwCO,KAAKG;;kBAEtDH,KAAKI,aAAa;;UAI5BH,EAAMI,mBAAmB,aAAcH,CAAM,EAE7CF,KAAKM,cAAc,EACnBN,KAAKO,WAAW,CACpB,CAEAH,eACI,OAAOJ,KAAKQ,MAAM1B,IAAI,CAAC2B,EAAMC;;wEAGmCD,UAAaT,KAAKP,QAAQiB;;aAGzF,EACAC,KAAK,EAAE,CACZ,CAEAL,gBACI,MAAMM,EAAY1D,SAASC,eAAe,UAAU6C,KAAKG,EAAI,EAE7DS,EAAUzB,iBAAiB,QAAS7B,UAChCF,OAAOgB,UAAUC,IAAI,SAAS,EAE9B,MAAMwC,EAAc3D,SAASC,eAAe,GAAG6C,KAAKG,EAAI,GAElCjC,MAAMb,WAAW,YAAY2C,KAAKG,GAAM,QAAQ,GAEpDA,IACdU,EAAYtC,OAAO,CAE3B,CAAC,CACL,CAEAgC,aACIP,KAAKQ,MAAM1B,IAAI,CAAC2B,EAAMC,EAAGI,KACrB,MAAMC,EAAc7D,SAASC,eAAkB6C,KAAKP,KAAR,IAAgBiB,CAAG,EAE/DK,EAAY5B,iBAAiB,SAAU7B,UAEnCwD,EAAIJ,GAAKM,SAASD,EAAYxB,KAAK,EAEnC,IAAM9B,EAAO,CACT+C,MAAOM,CACX,EAEA5C,MAAMb,WAAW,YAAY2C,KAAKG,GAAM,MAAO1C,CAAI,CACvD,CAAC,CACL,CAAC,CACL,CACJ,CAEAmB,aAAa"}